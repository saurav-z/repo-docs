# StableAvatar: Generate Infinite-Length Audio-Driven Avatar Videos

**StableAvatar** revolutionizes video generation by creating high-fidelity, infinite-length avatar videos driven by audio, pushing the boundaries of what's possible in digital human creation.  [Explore the original repository](https://github.com/Francis-Rings/StableAvatar).

<p align="center">
  <a href='https://francis-rings.github.io/StableAvatar'><img src='https://img.shields.io/badge/Project-Page-Green'></a> <a href='https://arxiv.org/abs/2508.08248'><img src='https://img.shields.io/badge/Paper-Arxiv-red'></a> <a href='https://huggingface.co/FrancisRing/StableAvatar/tree/main'><img src='https://img.shields.io/badge/HuggingFace-Model-orange'></a> <a href='https://huggingface.co/spaces/YinmingHuang/StableAvatar'><img src='https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Demo-blue'></a> <a href='https://www.youtube.com/watch?v=6lhvmbzvv3Y'><img src='https://img.shields.io/badge/YouTube-Watch-red?style=flat-square&logo=youtube'></a> <a href='https://www.bilibili.com/video/BV1hUt9z4EoQ'><img src='https://img.shields.io/badge/Bilibili-Watch-blue?style=flat-square&logo=bilibili'></a>
</p>

*   **Infinite-Length Video Generation:** Create videos of any length without degradation.
*   **Identity Preservation:** Ensures the generated avatar maintains its unique identity throughout the video.
*   **End-to-End Synthesis:** Generates videos directly without the need for post-processing tools like face swapping or restoration.
*   **High-Fidelity Output:** Delivers high-quality video with natural audio synchronization.
*   **Time-step-aware Audio Adapter:** Prevents latent distribution errors during long video generation.
*   **Audio Native Guidance Mechanism:** Enhance audio synchronization by leveraging the diffusionâ€™s own evolving joint audio-latent prediction as a dynamic guidance signal.
*   **Dynamic Weighted Sliding-window Strategy:** Introduce a Dynamic Weighted Sliding-window Strategy that fuses latent over time to enhance the smoothness of the infinite-length videos.

<table border="0" style="width: 100%; text-align: left; margin-top: 20px;">
  <tr>
      <td>
          <video src="https://github.com/user-attachments/assets/d7eca208-6a14-46af-b337-fb4d2b66ba8d" width="320" controls loop></video>
      </td>
      <td>
          <video src="https://github.com/user-attachments/assets/b15784b1-c013-4126-a764-10c844341a4e" width="320" controls loop></video>
      </td>
       <td>
          <video src="https://github.com/user-attachments/assets/87faa5c1-a118-4a03-a071-45f18e87e6a0" width="320" controls loop></video>
     </td>
  </tr>
  <tr>
      <td>
          <video src="https://github.com/user-attachments/assets/531eb413-8993-4f8f-9804-e3c5ec5794d4" width="320" controls loop></video>
      </td>
      <td>
          <video src="https://github.com/user-attachments/assets/cdc603e2-df46-4cf8-a14e-1575053f996f" width="320" controls loop></video>
      </td>
       <td>
          <video src="https://github.com/user-attachments/assets/7022dc93-f705-46e5-b8fc-3a3fb755795c" width="320" controls loop></video>
     </td>
  </tr>
  <tr>
      <td>
          <video src="https://github.com/user-attachments/assets/0ba059eb-ff6f-4d94-80e6-f758c613b737" width="320" controls loop></video>
      </td>
      <td>
          <video src="https://github.com/user-attachments/assets/03e6c1df-85c6-448d-b40d-aacb8add4e45" width="320" controls loop></video>
      </td>
       <td>
          <video src="https://github.com/user-attachments/assets/90b78154-dda0-4eaa-91fd-b5485b718a7f" width="320" controls loop></video>
     </td>
  </tr>
</table>

<p style="text-align: justify;">
  <span>Audio-driven avatar videos generated by StableAvatar, showing its power to synthesize <b>infinite-length</b> and <b>ID-preserving videos</b>. All videos are <b>directly synthesized by StableAvatar without the use of any face-related post-processing tools</b>, such as the face-swapping tool FaceFusion or face restoration models like GFP-GAN and CodeFormer.</span>
</p>

<p align="center">
  <video src="https://github.com/user-attachments/assets/90691318-311e-40b9-9bd9-62db83ab1492" width="768" autoplay loop muted playsinline></video>
  <br/>
  <span>Comparison results between StableAvatar and state-of-the-art (SOTA) audio-driven avatar video generation models highlight the superior performance of StableAvatar in delivering <b>infinite-length, high-fidelity, identity-preserving avatar animation</b>.</span>
</p>

## Key Features

*   **End-to-End Generation:** Produce high-quality avatar videos directly from audio input.
*   **Infinite Video Length:** Generate videos of unlimited duration.
*   **Identity Consistency:** Maintain the avatar's unique identity throughout the entire video.
*   **Superior Audio Synchronization:** Achieve natural lip-sync and realistic audio-visual interactions.
*   **No Post-Processing Required:** Eliminate the need for external face-related processing tools.

## Quickstart Guide

### ðŸ§± Environment Setup

```bash
pip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.1.1 --index-url https://download.pytorch.org/whl/cu124
pip install -r requirements.txt
# Optional to install flash_attn to accelerate attention computation
pip install flash_attn
```

### ðŸ§± Environment setup for Blackwell series chips

```bash
pip install torch==2.7.0 torchvision==0.22.0 torchaudio==2.7.0 --index-url https://download.pytorch.org/whl/cu128
pip install -r requirements.txt
# Optional to install flash_attn to accelerate attention computation
pip install flash_attn
```

### ðŸ§± Download Weights

```bash
pip install "huggingface_hub[cli]"
cd StableAvatar
mkdir checkpoints
huggingface-cli download FrancisRing/StableAvatar --local-dir ./checkpoints
```

### ðŸ§± Audio Extraction

```bash
python audio_extractor.py --video_path="path/test/video.mp4" --saved_audio_path="path/test/audio.wav"
```

### ðŸ§± Vocal Separation (Optional)

```bash
pip install audio-separator[gpu]
python vocal_seperator.py --audio_separator_model_file="path/StableAvatar/checkpoints/Kim_Vocal_2.onnx" --audio_file_path="path/test/audio.wav" --saved_vocal_path="path/test/vocal.wav"
```

### ðŸ§± Base Model Inference

Modify `inference.sh` for your desired video generation settings, including resolution, prompts, and model paths.

```bash
bash inference.sh
```

### ðŸ§± Gradio Interface

```bash
python app.py
```

**For detailed instructions and further customization options, please refer to the full documentation in the original repository.**

## Training Guide

The training data should be organized as follows:

```
talking_face_data/
â”œâ”€â”€ rec
â”‚Â Â  â”‚Â Â â”œâ”€â”€speech
â”‚Â Â  â”‚Â Â â”‚Â Â â”œâ”€â”€00001
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€sub_clip.mp4
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€audio.wav
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€images
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€frame_0.png
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€frame_1.png
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€frame_2.png
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€...
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€face_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€frame_0.png
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€frame_1.png
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€frame_2.png
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€...
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€lip_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€frame_0.png
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€frame_1.png
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€frame_2.png
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€...
â”‚Â Â  â”‚Â Â â”‚Â Â â”œâ”€â”€00002
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€sub_clip.mp4
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€audio.wav
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€images
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€face_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€lip_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â””â”€â”€...
â”‚Â Â  â”‚Â Â â”œâ”€â”€singing
â”‚Â Â  â”‚Â Â â”‚Â Â â”œâ”€â”€00001
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€sub_clip.mp4
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€audio.wav
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€images
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€face_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€lip_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â””â”€â”€...
â”‚Â Â  â”‚Â Â â”œâ”€â”€dancing
â”‚Â Â  â”‚Â Â â”‚Â Â â”œâ”€â”€00001
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€sub_clip.mp4
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€audio.wav
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€images
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€face_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€lip_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â””â”€â”€...
â”œâ”€â”€ vec
â”‚Â Â  â”‚Â Â â”œâ”€â”€speech
â”‚Â Â  â”‚Â Â â”‚Â Â â”œâ”€â”€00001
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€sub_clip.mp4
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€audio.wav
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€images
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€face_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€lip_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â””â”€â”€...
â”‚Â Â  â”‚Â Â â”œâ”€â”€singing
â”‚Â Â  â”‚Â Â â”‚Â Â â”œâ”€â”€00001
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€sub_clip.mp4
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€audio.wav
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€images
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€face_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€lip_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â””â”€â”€...
â”‚Â Â  â”‚Â Â â”œâ”€â”€dancing
â”‚Â Â  â”‚Â Â â”‚Â Â â”œâ”€â”€00001
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€sub_clip.mp4
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€audio.wav
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€images
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€face_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€lip_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â””â”€â”€...
â”œâ”€â”€ square
â”‚Â Â  â”‚Â Â â”œâ”€â”€speech
â”‚Â Â  â”‚Â Â â”‚Â Â â”œâ”€â”€00001
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€sub_clip.mp4
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€audio.wav
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€images
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€face_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€lip_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â””â”€â”€...
â”‚Â Â  â”‚Â Â â”œâ”€â”€singing
â”‚Â Â  â”‚Â Â â”‚Â Â â”œâ”€â”€00001
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€sub_clip.mp4
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€audio.wav
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€images
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€face_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€lip_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â””â”€â”€...
â”‚Â Â  â”‚Â Â â”œâ”€â”€dancing
â”‚Â Â  â”‚Â Â â”‚Â Â â”œâ”€â”€00001
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€sub_clip.mp4
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€audio.wav
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€images
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€face_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€â”€lip_masks
â”‚Â Â  â”‚Â Â â”‚Â Â â””â”€â”€...
â”œâ”€â”€ video_rec_path.txt
â”œâ”€â”€ video_square_path.txt
â””â”€â”€ video_vec_path.txt
```

Then you can run:

```bash
# Training StableAvatar on a single resolution setting (512x512) in a single machine
bash train_1B_square.sh
# Training StableAvatar on a single resolution setting (512x512) in multiple machines
bash train_1B_square_64.sh
# Training StableAvatar on a mixed resolution setting (480x832 and 832x480) in a single machine
bash train_1B_rec_vec.sh
# Training StableAvatar on a mixed resolution setting (480x832 and 832x480) in multiple machines
bash train_1B_rec_vec_64.sh
```

## Citation

If you find our work helpful, please consider citing it:

```bib
@article{tu2025stableavatar,
  title={Stableavatar: Infinite-length audio-driven avatar video generation},
  author={Tu, Shuyuan and Pan, Yueming and Huang, Yinming and Han, Xintong and Xing, Zhen and Dai, Qi and Luo, Chong and Wu, Zuxuan and Jiang, Yu-Gang},
  journal={arXiv preprint arXiv:2508.08248},
  year={2025}
}
```

## Contact

For any suggestions or inquiries, please contact francisshuyuan@gmail.com.